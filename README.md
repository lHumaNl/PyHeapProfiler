# PyHeapProfiler

PyHeapProfiler is a tool designed to profile heap dumps of Python applications. This project facilitates the collection,
comparison, and analysis of metadata from objects in memory, enabling developers to better understand memory usage and
track memory leaks in Python programs. The heap dumps are generated in JSON format and can be loaded, visualized, and
compared using a graphical interface.

## Features

- **Heap Dump Collection**: Collect metadata from all objects currently in memory using Python's garbage collector (gc)
  and additional code objects (functions, methods).
- **Heap Dump Analysis**: View and analyze the memory usage of Python objects. Attributes such as object size,
  references, and source code information are included.
- **Comparison Mode**: Load two heap dumps and compare them to track changes in memory usage, such as added, deleted,
  and modified objects between different memory snapshots.
- **GUI Interface**: PyHeapProfiler comes with a PySide6-based GUI to load and compare heap dumps, providing a visual
  summary and detailed breakdown of the memory consumption.
- **Lazy Loading**: Efficiently handle large dumps by lazily loading objects as needed, avoiding memory overload in the
  profiler itself.

## Requirements

To run PyHeapProfiler, you need the following dependencies installed:

- Python 3.8+
- PySide6 (for the graphical interface)

You can install the required dependencies by running:

```bash
pip install -r requirements.txt
```

## How It Works

### Heap Dump Generation

PyHeapProfiler works with heap dumps generated by the [PyHeapDumper](https://github.com/lHumaNl/PyHeapDumper) tool. The
heap dumper collects metadata about objects in memory, including their size, attributes, references, and source code
locations. Dumps are stored in JSON format for easy processing.

The heap dump files include information such as:

- Object type and size
- Object attributes (for objects with `__dict__`)
- Object references (i.e., objects referenced by the current object)
- Source code information (for functions, methods, and classes)

### Loading and Comparing Dumps

PyHeapProfiler provides a simple GUI for loading and comparing heap dumps. Users can load a heap dump and view
summarized data such as the total number of objects and total memory usage. Additionally, users can load a second heap
dump for comparison to identify changes between memory snapshots.

1. **Load a Heap Dump**: The profiler will display the total objects and memory usage, broken down by object type.
2. **Compare with Another Dump**: After loading a second dump, the profiler will highlight new objects, deleted objects,
   and changes in memory usage between the two dumps.

### Visual Analysis

The main window presents the following data:

- Object type
- Number of objects per type
- Total size per type
- Percentage of total objects and memory used by each type

In comparison mode, additional columns show:

- Object counts and memory usage for both the main and comparison dumps
- Differences in object counts and memory usage
- New and deleted objects, as well as changes in attributes and references

## Usage

1. **Start the application**: You can start the profiler by running main.py:

```bash
python main.py
```

This will open the graphical interface where you can load and compare heap dumps.

2. **Load a heap dump**: Use the "Load Heap Dump" button to select a heap dump file in JSON format.

3. **Compare dumps**: To compare two dumps, first load the initial heap dump, then use the "Load for Comparison" button
   to load the second heap dump.

4. **View detailed object information**: By clicking on an object type or individual objects in the table, you can view
   their attributes, references, and source code information.